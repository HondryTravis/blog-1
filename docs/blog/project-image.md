# 项目中的图片类型选择

在 HTTP 一节中，我们知道一个页面在渲染的时候除了 HTML，JS，CSS 以外，还包括了很多第三方资源，包括图片，视频以及其他多媒体资源，这些第三方资源往往会比较大，可能会在加载的时候产生性能问题，这一节我们就来讨论一下如何选择图片？

其实，页面中的 HTML，JS，CSS 通过压缩合并打包后，体积已经减小了很多，再想更进一步优化很难。可是页面中的图片不一样，各种类型的图片在压缩以后大小差别比较大，在合适的地方选择合适类型的图片是我们这一节的主要讨论点。

## 常见图片格式

当前网页中常用的图片格式如下：

- JPEG
- PNG
- GIF
- SVG
- APNG (GIF 的替代者，兼容性不佳)
- WebP (JPEG 的替代者，兼容性不佳)

首先，我们优化图片的目的是在`相同的画质基础上`，尽可能地让`图片大小更小`。

### 位图和矢量图

- 位图：记录的是图片上每一个像素点的色相、饱和度、明度。当你打开一张图片时，会根据记录的每一个像素点进行排列，将排列的结果显示给你看。
- 矢量图：记录的是元素形状及颜色的算法，当你打开一张图片时，会根据图中的算法进行运算，将运算结果显示给你看。

::: warning 注意

- 位图不能放太大，减少文件分辨率后会影响图片质量，优点是能很细腻地表达图片的效果。
- 矢量图可以无限放大或缩小，不会影响图片质量，文件体积较小，编辑灵活。缺点是表达的色彩层次不清，整体观感效果不如位图。

:::

上述的格式中， SVG 属于矢量图，JPEG，PNG，GIF 属于位图。

### 详细介绍

这一节我们详细地理解一下上面提到的图片格式。首先介绍一下`索引色`和`直接色`。

#### 索引色和直接色

索引色（Indexed Color）：挑选一副图片中最有代表性的若干种颜色（通常不超过 256 种），编制成颜色表。在表示图片中每一个点的颜色信息时，不直接使用这个点的颜色信息，而使用颜色表的索引。

直接色 (direct color)：使用四个数字来代表一种颜色，这四个数字分别代表这个颜色中红色 R、绿色 G、蓝色 B 以及透明度 A。这四个维度分别支持 256 种变化，所以直接色可以表示 2 的 32 次方种颜色。

::: warning 注意

- 索引色存储量小，能大大减少图片的大小，但色彩量较小的图片。
- 直接色存储量大，能够表达生动的图像效果，但图片的大小较大。

:::

#### SVG

SVG 是`无损的`、`矢量图`。在它内部存储着图片绘制的函数，通常包括绘制点，线，常规图形等。

- 体积小。
- 无损压缩。
- 图片质量最佳，但不适合过渡，渐变等细腻的颜色。

#### JPEG

JPEG 是`有损的`、采用`直接色`的、`位图`。

- 有损压缩，体积可以压的更小。
- 直接色，颜色丰富，适合表达细腻的颜色。

JPEG 非常适合用来存储照片，用来表达更生动的图像效果，比如颜色渐变。

#### PNG

PNG 又分为 PNG-8 和 PNG-24。

##### PNG-8

PNG-8 是 PNG 的`索引色`版本。PNG-8 是`无损的`、使用`索引色`的、`位图`。

- 支持透明。
- 无损压缩，体积大。
- 索引色，颜色不丰富。

##### PNG-24

PNG-24 是 PNG 的`直接色`版本。PNG-24 是`无损的`、使用`直接色`的、`位图`。

- 支持透明。
- 无损压缩，体积大。
- 直接色，颜色丰富，体积大。

#### GIF

GIF 是`无损的`、采用`索引色`的、`位图`。但得益于数据的压缩，GIF 格式的图片。文件小，是 GIF 格式的优点，同时，GIF 格式还具有支持动画以及透明的优点。但，GIF 格式仅支持 8bit 的索引色，即在整个图片中，只能存在 256 种不同的颜色。

- 支持透明。
- 支持动画。
- 无损压缩，体积大。
- 索引色，颜色不丰富。

#### WebP

WebP 是谷歌开发的一种新图片格式，WebP 是同时`支持有损和无损压缩`的、使用`直接色`的、`位图`。

在无损压缩的情况下，相同质量的 WebP 图片，文件大小要比 PNG 小 26%；

在有损压缩的情况下，具有相同图片精度的 WebP 图片，文件大小要比 JPEG 小 25%~34%；

## 如何减少图片大小？

我们通过图片压缩的方式来减少图片大小，图片压缩又分为有损压缩和无损压缩。

- 无损压缩：使用“无损”过滤器处理图像，对像素数据进行压缩。意味着图像变小的同时，不会对图片质量造成损害。
- 有损压缩：使用“有损”过滤器处理图像，去除某些像素数据。意味着图像可以被压缩得更小，但对质量有害。如果你一次又一次地以有损压缩保存图像，图像质量会越来越差。

:::tip
由于矢量图是通过函数计算的出来的，所以对矢量图的压缩，都是无损压缩。
:::

上述的格式中，无损压缩的有：GIF，PNG。有损压缩的有：JPEG。

## 图片选择方案

1、首选矢量图形。

2、选择适合的位图，位图选择流程图如下：

![位图选择](project-image.png)
